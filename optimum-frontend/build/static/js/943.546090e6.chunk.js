"use strict";(self.webpackChunkoptimum_frontend=self.webpackChunkoptimum_frontend||[]).push([[943],{8943:(e,t,s)=>{s.r(t),s.d(t,{default:()=>W});var i=s(5043),a=s(1180),n=s(6992),r=s(6102),o=s(7869),l=s(379),d=s(95),c=s(5748),u=s(7734),h=s(2185),x=s(6026),m=s(6295),g=s(2291),p=s(23),f=s(4505),b=s(6446),j=s(9570),y=s(9926),v=s(579);const S=e=>{let{onAlertAction:t}=e;const[s,a]=(0,i.useState)([]),[n,r]=(0,i.useState)(!0),[o,l]=(0,i.useState)(new Set);(0,i.useEffect)(()=>{let e;d();const t=()=>{if(window.requestIdleCallback){const s=window.requestIdleCallback(()=>{d(),e=setTimeout(t,45e3)},{timeout:5e3});e={timeout:null,idle:s}}else e=setTimeout(()=>{d(),t()},45e3)};return e=setTimeout(t,45e3),()=>{var t;"number"===typeof e?clearTimeout(e):null!==(t=e)&&void 0!==t&&t.idle&&window.cancelIdleCallback&&(window.cancelIdleCallback(e.idle),e.timeout&&clearTimeout(e.timeout))}},[]);const d=async()=>{try{r(!0);const e=await f.f3.getPredictiveAlerts();e.data.success&&a(e.data.alerts||[])}catch(e){console.error("Error loading alerts:",e)}finally{r(!1)}},c=e=>{switch(e){case"error":return(0,v.jsx)(y.t5W,{className:"alert-icon error"});case"warning":return(0,v.jsx)(y.t5W,{className:"alert-icon warning"});default:return(0,v.jsx)(y._AI,{className:"alert-icon info"})}},u=s.filter((e,t)=>!o.has(t));return n&&0===s.length?null:0===u.length?(0,v.jsxs)(b.P.div,{className:"predictive-alerts empty",initial:{opacity:0},animate:{opacity:1},children:[(0,v.jsx)(y.OLr,{className:"empty-icon"}),(0,v.jsx)("p",{children:"All systems running smoothly! No alerts at this time."})]}):(0,v.jsxs)(b.P.div,{className:"predictive-alerts",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[(0,v.jsxs)("div",{className:"alerts-header",children:[(0,v.jsx)("h3",{children:"Predictive Alerts"}),(0,v.jsx)("button",{className:"refresh-btn",onClick:d,title:"Refresh alerts",children:"Refresh"})]}),(0,v.jsx)("div",{className:"alerts-list",children:(0,v.jsx)(j.N,{children:u.map((e,s)=>(0,v.jsxs)(b.P.div,{className:"alert-item ".concat(e.type," priority-").concat(e.priority),initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{delay:.1*s},children:[(0,v.jsxs)("div",{className:"alert-content",children:[c(e.type),(0,v.jsxs)("div",{className:"alert-text",children:[(0,v.jsx)("h4",{children:e.title}),(0,v.jsx)("p",{children:e.message})]})]}),(0,v.jsxs)("div",{className:"alert-actions",children:[e.action&&(0,v.jsx)("button",{className:"action-btn",onClick:()=>(e=>{t&&t(e.action)})(e),children:"View"}),(0,v.jsx)("button",{className:"dismiss-btn",onClick:()=>{return e=s,void l(t=>new Set([...t,e]));var e},title:"Dismiss alert",children:(0,v.jsx)(y.U_s,{})})]})]},s))})})]})},w=e=>{var t,s,a,n,r;let{onSelectSuggestion:o}=e;const[l,d]=(0,i.useState)(null),[c,u]=(0,i.useState)(!0);(0,i.useEffect)(()=>{h()},[]);const h=async()=>{try{u(!0);const e=await f.f3.getSmartSuggestions();e.data.success&&d(e.data.suggestions)}catch(e){console.error("Error loading suggestions:",e)}finally{u(!1)}};return c?(0,v.jsx)("div",{className:"smart-suggestions",children:(0,v.jsx)("div",{className:"loading",children:"Loading suggestions..."})}):l&&(null!==(t=l.suggested_products)&&void 0!==t&&t.length||null!==(s=l.suggested_suppliers)&&void 0!==s&&s.length)?(0,v.jsxs)(b.P.div,{className:"smart-suggestions",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[(0,v.jsxs)("div",{className:"suggestions-header",children:[(0,v.jsx)(y.pCw,{className:"header-icon"}),(0,v.jsx)("h3",{children:"Smart Suggestions"}),(0,v.jsx)("p",{children:"Based on your order history"})]}),(0,v.jsxs)("div",{className:"suggestions-grid",children:[(null===(a=l.suggested_products)||void 0===a?void 0:a.length)>0&&(0,v.jsxs)(b.P.div,{className:"suggestion-card",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1},children:[(0,v.jsxs)("div",{className:"card-header",children:[(0,v.jsx)(y.tJR,{className:"card-icon"}),(0,v.jsx)("h4",{children:"Suggested Products"})]}),(0,v.jsx)("div",{className:"suggestion-list",children:l.suggested_products.map((e,t)=>(0,v.jsxs)("button",{className:"suggestion-item",onClick:()=>(e=>{o&&o({type:"product",value:e.name})})(e),children:[(0,v.jsx)("span",{className:"item-name",children:e.name}),(0,v.jsxs)("span",{className:"item-count",children:[e.order_count," orders"]})]},t))})]}),(null===(n=l.suggested_suppliers)||void 0===n?void 0:n.length)>0&&(0,v.jsxs)(b.P.div,{className:"suggestion-card",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},children:[(0,v.jsxs)("div",{className:"card-header",children:[(0,v.jsx)(y.Od9,{className:"card-icon"}),(0,v.jsx)("h4",{children:"Suggested Suppliers"})]}),(0,v.jsx)("div",{className:"suggestion-list",children:l.suggested_suppliers.map((e,t)=>(0,v.jsxs)("button",{className:"suggestion-item",onClick:()=>(e=>{o&&o({type:"supplier",value:e.name})})(e),children:[(0,v.jsx)("span",{className:"item-name",children:e.name}),(0,v.jsxs)("span",{className:"item-count",children:[e.order_count," orders"]})]},t))})]}),(null===(r=l.recommendations)||void 0===r?void 0:r.length)>0&&(0,v.jsxs)(b.P.div,{className:"suggestion-card recommendations",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[(0,v.jsxs)("div",{className:"card-header",children:[(0,v.jsx)(y.n$Q,{className:"card-icon"}),(0,v.jsx)("h4",{children:"AI Recommendations"})]}),(0,v.jsx)("ul",{className:"recommendations-list",children:l.recommendations.map((e,t)=>(0,v.jsx)("li",{children:e},t))})]})]})]}):null},k=["rgba(74, 144, 226, 0.9)","rgba(80, 201, 206, 0.9)","rgba(59, 130, 246, 0.9)","rgba(107, 207, 127, 0.9)","rgba(74, 144, 226, 0.7)"],N=e=>{let{orders:t=[],onNavigate:s}=e;const[b,j]=(0,i.useState)(null),[y,N]=(0,i.useState)(!0),[W,z]=(0,i.useState)(80),[D,C]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e,t;R();const s=e=>{let t=400;e<=375?t=220:e<=480?t=250:e<=768?t=300:e<=1024&&(t=350),z(e=>e!==t?t:e)};if(requestAnimationFrame(()=>{s(window.innerWidth)}),!window.ResizeObserver){const e=()=>{clearTimeout(t),t=setTimeout(()=>{requestAnimationFrame(()=>{s(window.innerWidth)})},300)};return window.addEventListener("resize",e,{passive:!0}),()=>{window.removeEventListener("resize",e),clearTimeout(t)}}return e=new ResizeObserver(e=>{for(const i of e)clearTimeout(t),t=setTimeout(()=>{requestAnimationFrame(()=>{s(i.contentRect.width||window.innerWidth)})},300)}),document.body&&e.observe(document.body),()=>{e&&e.disconnect(),clearTimeout(t)}},[]);const R=async()=>{try{const e=await f.gH.getDashboardStats();j(e.data)}catch(e){console.error("Error fetching stats:",e)}finally{N(!1)}},P=(0,i.useMemo)(()=>t.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{}),[t]),K=(0,i.useMemo)(()=>[{name:"Pending",value:P.pending||0},{name:"In Preparation",value:P["in-preparation"]||0},{name:"Ready",value:P.ready||0},{name:"Delivered",value:P.delivered||0}],[P]),T=(0,i.useMemo)(()=>t.filter(e=>e.totalAmount).reduce((e,t)=>{const s=new Date(t.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric"}),i=e.find(e=>e.date===s);return i?i.revenue+=t.totalAmount||0:e.push({date:s,revenue:t.totalAmount||0}),e},[]).sort((e,t)=>new Date(e.date)-new Date(t.date)).slice(-7),[t]),A=(0,i.useMemo)(()=>t.reduce((e,t)=>{const s=new Date(t.createdAt).toLocaleDateString("en-US",{month:"short",day:"numeric"});return e[s]=(e[s]||0)+1,e},{}),[t]),_=(0,i.useMemo)(()=>Object.entries(A).map(e=>{let[t,s]=e;return{date:t,orders:s}}).sort((e,t)=>new Date(e.date)-new Date(t.date)).slice(-7),[A]),E=(0,i.useMemo)(()=>t.reduce((e,t)=>{const s=t.productType||"Unknown";return e[s]=(e[s]||0)+1,e},{}),[t]),L=(0,i.useMemo)(()=>Object.entries(E).map(e=>{let[t,s]=e;return{name:t,count:s}}).sort((e,t)=>t.count-e.count).slice(0,5),[E]),O=(0,i.memo)(e=>{let{title:t,value:s,icon:i,color:a,delay:n=0}=e;return(0,v.jsxs)("div",{className:"stat-card",children:[(0,v.jsx)("div",{className:"stat-icon",style:{background:"".concat(a,"20"),color:a},children:i}),(0,v.jsxs)("div",{className:"stat-content",children:[(0,v.jsx)("p",{className:"stat-title",children:t}),(0,v.jsx)("h3",{className:"stat-value",children:s})]})]})});return y?(0,v.jsx)("div",{className:"loading",children:"Loading dashboard..."}):(0,v.jsxs)("div",{className:"modern-dashboard",children:[(0,v.jsxs)("div",{className:"dashboard-header",children:[(0,v.jsx)("h1",{children:"Dashboard Overview"}),(0,v.jsx)("p",{children:"Real-time insights and analytics"})]}),(0,v.jsx)(S,{onAlertAction:e=>{"view_orders"===e&&(console.log("Navigate to orders"),"function"===typeof s&&s("orders"))}}),(0,v.jsx)(w,{}),(0,v.jsxs)("div",{className:"stats-grid",children:[(0,v.jsx)(O,{title:"Total Orders",value:(null===b||void 0===b?void 0:b.total_orders)||t.length,icon:"\ud83d\udcca",color:"rgba(74, 144, 226, 1)",delay:.1}),(0,v.jsx)(O,{title:"Total Revenue",value:"$".concat(((null===b||void 0===b?void 0:b.total_revenue)||0).toLocaleString()),icon:"\ud83d\udcb0",color:"rgba(80, 201, 206, 1)",delay:.2}),(0,v.jsx)(O,{title:"Pending Orders",value:(null===b||void 0===b?void 0:b.pending_orders)||P.pending||0,icon:"\u23f3",color:"rgba(59, 130, 246, 1)",delay:.3}),(0,v.jsx)(O,{title:"Upcoming Deliveries",value:(null===b||void 0===b?void 0:b.upcoming_deliveries)||0,icon:"\ud83d\ude9a",color:"rgba(107, 207, 127, 1)",delay:.4})]}),(0,v.jsxs)("div",{className:"charts-grid",children:[(0,v.jsxs)("div",{className:"chart-card",onClick:()=>C("status"),role:"button",tabIndex:0,"aria-label":"View order status distribution in full screen",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),C("status"))},children:[(0,v.jsx)("h3",{children:"Order Status Distribution"}),(0,v.jsx)(a.u,{width:"100%",height:W,children:(0,v.jsxs)(n.r,{children:[(0,v.jsx)(r.F,{data:K,cx:"50%",cy:"50%",labelLine:!0,label:e=>{let{name:t,percent:s}=e;return"".concat(t," ").concat((100*s).toFixed(0),"%")},outerRadius:Math.min(.35*W,120),fill:"#8884d8",dataKey:"value",fontSize:14,fontWeight:600,children:K.map((e,t)=>(0,v.jsx)(o.f,{fill:k[t%k.length]},"cell-".concat(t)))}),(0,v.jsx)(l.m,{contentStyle:{fontSize:"14px",fontWeight:600,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"14px",fontWeight:500},iconSize:16})]})})]}),(0,v.jsxs)("div",{className:"chart-card",onClick:()=>C("revenue"),role:"button",tabIndex:0,"aria-label":"View revenue trend in full screen",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),C("revenue"))},children:[(0,v.jsx)("h3",{children:"Revenue Trend (Last 7 Days)"}),(0,v.jsx)(a.u,{width:"100%",height:W,children:(0,v.jsxs)(c.b,{data:T,children:[(0,v.jsx)(u.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,v.jsx)(h.W,{dataKey:"date",fontSize:13,fontWeight:500,tick:{fill:"#6b7280"},height:50}),(0,v.jsx)(x.h,{fontSize:13,fontWeight:500,tick:{fill:"#6b7280"},width:80,tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,v.jsx)(l.m,{formatter:e=>["$".concat(e.toLocaleString()),"Revenue"],contentStyle:{fontSize:"14px",fontWeight:600,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"14px",fontWeight:500},iconSize:16}),(0,v.jsx)(m.N,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:3,dot:{r:5,fill:"#3b82f6"},activeDot:{r:7}})]})})]})]}),(0,v.jsxs)("div",{className:"charts-grid",children:[(0,v.jsxs)("div",{className:"chart-card",onClick:()=>C("orders"),role:"button",tabIndex:0,"aria-label":"View orders by day in full screen",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),C("orders"))},children:[(0,v.jsx)("h3",{children:"Orders by Day (Last 7 Days)"}),(0,v.jsx)(a.u,{width:"100%",height:W,children:(0,v.jsxs)(g.E,{data:_,children:[(0,v.jsx)(u.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,v.jsx)(h.W,{dataKey:"date",fontSize:13,fontWeight:500,tick:{fill:"#6b7280"},height:50}),(0,v.jsx)(x.h,{fontSize:13,fontWeight:500,tick:{fill:"#6b7280"},width:50}),(0,v.jsx)(l.m,{contentStyle:{fontSize:"14px",fontWeight:600,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"14px",fontWeight:500},iconSize:16}),(0,v.jsx)(p.y,{dataKey:"orders",fill:"#10b981",radius:[8,8,0,0],label:{position:"top",fontSize:12,fontWeight:600}})]})})]}),(0,v.jsxs)("div",{className:"chart-card",onClick:()=>C("topProducts"),role:"button",tabIndex:0,"aria-label":"View top products in full screen",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),C("topProducts"))},children:[(0,v.jsx)("h3",{children:"Top Products"}),(0,v.jsx)(a.u,{width:"100%",height:W,children:(0,v.jsxs)(g.E,{data:L,layout:"vertical",children:[(0,v.jsx)(u.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,v.jsx)(h.W,{type:"number",fontSize:13,fontWeight:500,tick:{fill:"#6b7280"}}),(0,v.jsx)(x.h,{dataKey:"name",type:"category",width:140,fontSize:13,fontWeight:500,tick:{fill:"#6b7280"}}),(0,v.jsx)(l.m,{contentStyle:{fontSize:"14px",fontWeight:600,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"8px 12px"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"14px",fontWeight:500},iconSize:16}),(0,v.jsx)(p.y,{dataKey:"count",fill:"#8b5cf6",radius:[0,8,8,0],label:{position:"right",fontSize:12,fontWeight:600}})]})})]})]}),D&&(0,v.jsx)("div",{className:"chart-fullscreen-backdrop",onClick:()=>C(null),role:"presentation",children:(0,v.jsxs)("div",{className:"chart-fullscreen-modal",onClick:e=>e.stopPropagation(),children:[(0,v.jsxs)("div",{className:"chart-fullscreen-header",children:[(0,v.jsxs)("h2",{children:["status"===D&&"Order Status Distribution","revenue"===D&&"Revenue Trend (Last 7 Days)","orders"===D&&"Orders by Day (Last 7 Days)","topProducts"===D&&"Top Products"]}),(0,v.jsx)("button",{type:"button",className:"chart-fullscreen-close",onClick:()=>C(null),"aria-label":"Close full screen chart view",children:"\xd7"})]}),(0,v.jsxs)("div",{className:"chart-fullscreen-body",children:["status"===D&&(0,v.jsx)(a.u,{width:"100%",height:"100%",children:(0,v.jsxs)(n.r,{children:[(0,v.jsx)(r.F,{data:K,cx:"50%",cy:"50%",labelLine:!0,label:e=>{let{name:t,percent:s}=e;return"".concat(t," ").concat((100*s).toFixed(0),"%")},outerRadius:180,fill:"#8884d8",dataKey:"value",fontSize:16,fontWeight:600,children:K.map((e,t)=>(0,v.jsx)(o.f,{fill:k[t%k.length]},"cell-full-".concat(t)))}),(0,v.jsx)(l.m,{contentStyle:{fontSize:"16px",fontWeight:600,backgroundColor:"rgba(255, 255, 255, 0.95)",border:"1px solid #e5e7eb",borderRadius:"8px",padding:"10px 14px"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"16px",fontWeight:500},iconSize:20})]})}),"revenue"===D&&(0,v.jsx)(a.u,{width:"100%",height:"100%",children:(0,v.jsxs)(c.b,{data:T,children:[(0,v.jsx)(u.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,v.jsx)(h.W,{dataKey:"date",fontSize:15,fontWeight:500,tick:{fill:"#e5e7eb"},height:60}),(0,v.jsx)(x.h,{fontSize:15,fontWeight:500,tick:{fill:"#e5e7eb"},width:100,tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,v.jsx)(l.m,{formatter:e=>["$".concat(e.toLocaleString()),"Revenue"],contentStyle:{fontSize:"16px",fontWeight:600,backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid rgba(148, 163, 184, 0.3)",borderRadius:"8px",padding:"10px 14px",color:"#e5e7eb"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"16px",fontWeight:500,color:"#e5e7eb"},iconSize:20}),(0,v.jsx)(m.N,{type:"monotone",dataKey:"revenue",stroke:"#3b82f6",strokeWidth:4,dot:{r:6,fill:"#3b82f6"},activeDot:{r:8}})]})}),"orders"===D&&(0,v.jsx)(a.u,{width:"100%",height:"100%",children:(0,v.jsxs)(g.E,{data:_,children:[(0,v.jsx)(u.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,v.jsx)(h.W,{dataKey:"date",fontSize:15,fontWeight:500,tick:{fill:"#e5e7eb"},height:60}),(0,v.jsx)(x.h,{fontSize:15,fontWeight:500,tick:{fill:"#e5e7eb"},width:60}),(0,v.jsx)(l.m,{contentStyle:{fontSize:"16px",fontWeight:600,backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid rgba(148, 163, 184, 0.3)",borderRadius:"8px",padding:"10px 14px",color:"#e5e7eb"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"16px",fontWeight:500,color:"#e5e7eb"},iconSize:20}),(0,v.jsx)(p.y,{dataKey:"orders",fill:"#10b981",radius:[10,10,0,0],label:{position:"top",fontSize:14,fontWeight:600,fill:"#e5e7eb"}})]})}),"topProducts"===D&&(0,v.jsx)(a.u,{width:"100%",height:"100%",children:(0,v.jsxs)(g.E,{data:L,layout:"vertical",children:[(0,v.jsx)(u.d,{strokeDasharray:"3 3",stroke:"#e5e7eb"}),(0,v.jsx)(h.W,{type:"number",fontSize:15,fontWeight:500,tick:{fill:"#e5e7eb"}}),(0,v.jsx)(x.h,{dataKey:"name",type:"category",width:180,fontSize:15,fontWeight:500,tick:{fill:"#e5e7eb"}}),(0,v.jsx)(l.m,{contentStyle:{fontSize:"16px",fontWeight:600,backgroundColor:"rgba(15, 23, 42, 0.95)",border:"1px solid rgba(148, 163, 184, 0.3)",borderRadius:"8px",padding:"10px 14px",color:"#e5e7eb"}}),(0,v.jsx)(d.s,{wrapperStyle:{fontSize:"16px",fontWeight:500,color:"#e5e7eb"},iconSize:20}),(0,v.jsx)(p.y,{dataKey:"count",fill:"#8b5cf6",radius:[0,12,12,0],label:{position:"right",fontSize:14,fontWeight:600,fill:"#e5e7eb"}})]})})]})]})})]})},W=(0,i.memo)(N)}}]);
//# sourceMappingURL=943.546090e6.chunk.js.map