"use strict";(self.webpackChunkoptimum_frontend=self.webpackChunkoptimum_frontend||[]).push([[970],{3970:(e,s,a)=>{a.r(s),a.d(s,{default:()=>d});var t=a(5043),n=a(9570),c=a(6446),i=a(9926),r=a(4505),l=a(579);const o=()=>{const[e,s]=(0,t.useState)([]),[a,o]=(0,t.useState)(""),[d,h]=(0,t.useState)(!1),[u,m]=(0,t.useState)(null),[g,x]=(0,t.useState)([]),j=(0,t.useRef)(null),p=(0,t.useRef)(null);(0,t.useEffect)(()=>{const e=localStorage.getItem("chat_session_id");if(e)m(e),f(e);else{const e="session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));m(e),localStorage.setItem("chat_session_id",e)}x(["How do I create a new order?","How do I filter orders?","What are the keyboard shortcuts?","How do I use AI features?","How do I update order status?","What charts are available?"])},[]),(0,t.useEffect)(()=>{var e;null===(e=j.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]);const f=async e=>{try{const a=await r.f3.getChatHistory(e);if(a.data.success){const e=a.data.messages.map(e=>({id:e.id,user:e.user_message,ai:e.ai_response,timestamp:e.created_at,type:e.message_type}));s(e)}}catch(a){console.error("Error loading chat history:",a)}},v=e=>{var s;o(e),null===(s=p.current)||void 0===s||s.focus()};return(0,l.jsxs)("div",{className:"chat-page",children:[(0,l.jsxs)("div",{className:"chat-page-header",children:[(0,l.jsxs)("div",{className:"header-left",children:[(0,l.jsx)(i.pCw,{className:"header-icon"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{children:"AI Chat Assistant"}),(0,l.jsx)("p",{children:"Get help with the Optimum Smart System"})]})]}),(0,l.jsx)("div",{className:"header-actions",children:e.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{className:"action-btn",onClick:()=>{const s=e.map(e=>{let s="[".concat(new Date(e.timestamp).toLocaleString(),"]\n");return e.user&&(s+="You: ".concat(e.user,"\n")),e.ai&&(s+="AI: ".concat(e.ai,"\n")),s}).join("\n---\n\n"),a=new Blob([s],{type:"text/plain"}),t=URL.createObjectURL(a),n=document.createElement("a");n.href=t,n.download="chat_history_".concat((new Date).toISOString().split("T")[0],".txt"),n.click(),URL.revokeObjectURL(t)},title:"Export chat",children:[(0,l.jsx)(i.cIQ,{}),"Export"]}),(0,l.jsxs)("button",{className:"action-btn danger",onClick:async()=>{if(u&&window.confirm("Are you sure you want to clear all chat history?"))try{await r.f3.clearChat(u),s([])}catch(e){console.error("Error clearing chat:",e)}},title:"Clear chat",children:[(0,l.jsx)(i.WWR,{}),"Clear"]})]})})]}),(0,l.jsxs)("div",{className:"chat-page-content",children:[(0,l.jsxs)("div",{className:"chat-sidebar",children:[(0,l.jsx)("h3",{children:"Quick Actions"}),(0,l.jsx)("div",{className:"quick-actions-list",children:g.map((e,s)=>(0,l.jsx)("button",{className:"quick-action-btn",onClick:()=>v(e),children:e},s))})]}),(0,l.jsxs)("div",{className:"chat-main",children:[(0,l.jsxs)("div",{className:"chat-messages-container",children:[0===e.length&&(0,l.jsxs)("div",{className:"chat-welcome-full",children:[(0,l.jsx)(i.pCw,{className:"welcome-icon-large"}),(0,l.jsx)("h2",{children:"Welcome to AI Chat Assistant"}),(0,l.jsx)("p",{children:"I can help you with:"}),(0,l.jsxs)("div",{className:"welcome-features",children:[(0,l.jsxs)("div",{className:"feature-card",children:[(0,l.jsx)("h4",{children:"System Navigation"}),(0,l.jsx)("p",{children:"Learn how to use features, keyboard shortcuts, and navigation"})]}),(0,l.jsxs)("div",{className:"feature-card",children:[(0,l.jsx)("h4",{children:"Order Management"}),(0,l.jsx)("p",{children:"Get help creating, filtering, and updating orders"})]}),(0,l.jsxs)("div",{className:"feature-card",children:[(0,l.jsx)("h4",{children:"Business Insights"}),(0,l.jsx)("p",{children:"Understand analytics, charts, and business data"})]}),(0,l.jsxs)("div",{className:"feature-card",children:[(0,l.jsx)("h4",{children:"General Questions"}),(0,l.jsx)("p",{children:"Ask anything about the system and get instant answers"})]})]}),(0,l.jsxs)("div",{className:"welcome-suggestions",children:[(0,l.jsx)("p",{children:"Try asking:"}),g.slice(0,3).map((e,s)=>(0,l.jsx)("button",{className:"welcome-suggestion-btn",onClick:()=>v(e),children:e},s))]})]}),(0,l.jsx)(n.N,{children:e.map(e=>(0,l.jsxs)(c.P.div,{className:"chat-message-group-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,scale:.9},children:[e.user&&(0,l.jsxs)("div",{className:"chat-message-full user-message-full",children:[(0,l.jsx)("div",{className:"message-avatar user-avatar",children:"You"}),(0,l.jsx)("div",{className:"message-content-full user-content",children:e.user})]}),e.ai&&(0,l.jsxs)("div",{className:"chat-message-full ai-message-full",children:[(0,l.jsx)("div",{className:"message-avatar ai-avatar",children:(0,l.jsx)(i.pCw,{})}),(0,l.jsxs)("div",{className:"message-content-full ai-content",children:[e.ai,e.suggestions&&e.suggestions.length>0&&(0,l.jsx)("div",{className:"message-suggestions-full",children:e.suggestions.map((e,s)=>(0,l.jsx)("button",{className:"suggestion-btn-full",onClick:()=>v(e),children:e},s))})]})]})]},e.id))}),d&&(0,l.jsxs)("div",{className:"chat-message-full ai-message-full",children:[(0,l.jsx)("div",{className:"message-avatar ai-avatar",children:(0,l.jsx)(i.pCw,{})}),(0,l.jsxs)("div",{className:"message-content-full ai-content typing-full",children:[(0,l.jsx)("span",{}),(0,l.jsx)("span",{}),(0,l.jsx)("span",{})]})]}),(0,l.jsx)("div",{ref:j})]}),(0,l.jsxs)("form",{className:"chat-input-full",onSubmit:async e=>{if(e.preventDefault(),!a.trim()||d)return;const t=a.trim();o("");const n={id:Date.now(),user:t,ai:null,timestamp:(new Date).toISOString()};s(e=>[...e,n]),h(!0);try{const e=await r.f3.chat(t,u,{include_orders:!0});if(e.data.success){const a={id:e.data.message_id||Date.now()+1,user:t,ai:e.data.response,timestamp:(new Date).toISOString(),suggestions:e.data.suggestions||[],type:e.data.message_type};s(e=>{const s=[...e];return s[s.length-1]=a,s})}}catch(c){console.error("Error sending message:",c);const e={id:Date.now()+1,user:t,ai:"Sorry, I'm having trouble connecting. Please try again later.",timestamp:(new Date).toISOString(),isError:!0};s(s=>{const a=[...s];return a[a.length-1]=e,a})}finally{h(!1)}},children:[(0,l.jsx)("input",{ref:p,type:"text",value:a,onChange:e=>o(e.target.value),placeholder:"Ask me anything about the system...",disabled:d}),(0,l.jsx)("button",{type:"submit",disabled:!a.trim()||d,children:(0,l.jsx)(i._Fn,{})})]})]})]})]})},d=(0,t.memo)(o)}}]);
//# sourceMappingURL=970.2c0dbbbe.chunk.js.map